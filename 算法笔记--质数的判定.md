---
title: 算法笔记--质数的判定
date: 2022-02-02 00:56:47
categories: algorithm
tags: [algorithm,计算机基础]
---

素数的判定是经常需要用到的算法之一，求素数也有很多种不同的算法，正好这里碰到了就汇总一下质数的判定的几种算法。

首先回顾一下质数和合数，质数就是指这个数的因子只有1和它本身，而合数指因为不止1和本身，这里需要注意，质数和合数都是对于$\ge 2$的数字而言，其他数字既不是质数，也不是合数。

算法基本基本定义:

$N\ = \ P_1^{\alpha_1} \times P_2^{\alpha_2} \times P_3^{\alpha_3} \times ... \times P_{n-1}^{\alpha_{n-1}}\times P_n^{\alpha_n}$

其中$P_1,P_2,P_3...P_{n-1},P_n$均为质数，且$\alpha_1,\alpha_2,\alpha_3...\alpha_{n-1},\alpha_n$均$\ge\ 0$。

## 试除法

这是最简单的方法，即从$[2..n-1]$遍历所有数，判断$n \% i$是否等于0即可，等于则说明$[2...n-1]$之间有可以被$n$整除的数，所以$n$不是质数。

```cpp
bool isPrime(int n) 
{
    // 1既不是质数也不是合数
    if(n == 1) return false;
	for(int i = 2; i < n; i++)
    {
        if(n % i == 0) return false;
    }
    return true;
}
```

时间复杂度为$O(n)$，空间复杂度为$O(1)$。

以上就是朴素的试除法，其中包括了大量重复计算，因为如果$n$是合数，那么必然存在$2 \le x \lt n$，$2 \le y \lt n$，使得$x \times y = n$。所以$x$或$y$必然有一个会先被枚举到，且如果是合数，另一个也会被枚举到，所以只需要枚举到$[\ 2...\sqrt{n}\ ]$即可。

如果这里采用$i \times i$比较容易爆出$int$，所以一般要用$long\ long$或者是转用开方。

```cpp
bool isPrime(int n)
{
    // 1既不是质数也不是合数
    if(n == 1) return false;
	for(int i = 2; i <= sqrt(n); i++)
    {
        if(n % i == 0) return false;
    }
    // 不想调用sqrt也可以改成为i * i <= n或者i <= n / i
    return true;
}
```

时间复杂度为$O(\sqrt{n})$，空间复杂度为$O(1)$。

